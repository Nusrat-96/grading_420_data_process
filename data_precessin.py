#--------------------------------------------------------------------------
# Package installation
#--------------------------------------------------------------------------
import pandas as pd
# to read excel file need to install openpyxl package


#--------------------------------------------------------------------------
# Load data
#--------------------------------------------------------------------------

df = pd.read_excel("Grading_402.xlsx", sheet_name="input")


#--------------------------------------------------------------------------
# Load data
#--------------------------------------------------------------------------
df["Color"] = df["Color"].ffill()



#--------------------------------------------------------------------------
# Melt table
#--------------------------------------------------------------------------

melted = df.melt(
    id_vars=["Color", "Inseam"],
    var_name="Size",
    value_name="Quantity"
)



#--------------------------------------------------------------------------
# Keep valid sizes
#--------------------------------------------------------------------------

melted = melted[melted["Size"].astype(str).str.contains("XL", case=False, na=False)]




#--------------------------------------------------------------------------
# Drop missing numeric values
#--------------------------------------------------------------------------
melted = melted.dropna(subset=["Inseam", "Quantity"]).reset_index(drop=True)


#--------------------------------------------------------------------------
# Convert to integer safely
#--------------------------------------------------------------------------

melted["Inseam"] = melted["Inseam"].astype(int)
melted["Quantity"] = melted["Quantity"].astype(int)

print(melted.head(10))


#--------------------------------------------------------------------------
# Save cleaned data
#--------------------------------------------------------------------------
melted.to_excel("Grading_402_cleaned.xlsx", sheet_name="output", index=False)
print("âœ… Saved as 'Grading_402_cleaned.xlsx'")
